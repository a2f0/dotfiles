#!/bin/sh

# delete other branches
dlob () {
    git remote prune origin
    git branch | grep -v "$(git branch --show-current)" | xargs git branch -D
}

ytdlp_install () {
    python3 -m pip install -U --pre yt-dlp
    yt-dlp --version
}

rip () {
    yt-dlp --extract-audio --audio-format mp3 "$1" --add-metadata "$1" --embed-thumbnail
}

ripvideo () {
    yt-dlp --format "bestvideo*+bestaudio/best" --merge-output-format mp4 --recode-video mp4 "$1" --add-metadata --embed-thumbnail
}

ide () {
    tmux new-session -d nvim
    tmux split-window -v
    tmux split-window -h
    tmux select-layout main-horizontal
    tmux select-pane -t 0
    tmux attach-session -d
}

# To reattach: tmux attach
tearleads () {
    tmux new-session -d -c "$HOME/github/tearleads-main" -n tearleads-main
    i=2
    while [ "$i" -le 20 ]; do
        tmux new-window -c "$HOME/github/rapid${i}" -n "rapid${i}"
        i=$((i + 1))
    done
    tmux select-window -t 0
    tmux attach-session -d
}

killport () {
    if ! lsof -i :"$1" >/dev/null 2>&1; then
        echo "No process found listening on port $1"
        return 0
    fi
    lsof -i :"$1" | awk 'NR>1 {print $2}' | xargs kill -9
}
